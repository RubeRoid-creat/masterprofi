# üîî Real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Socket.io –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ**

- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `socket.io-client`
- ‚úÖ –°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å `SocketService` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–≤—è–∑–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω

### 2. **Toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**

- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `Toast` —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
- ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç `NotificationContext` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- ‚úÖ 4 —Ç–∏–ø–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: `success`, `error`, `warning`, `info`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–∫—Ä—ã—Ç—å –≤—Ä—É—á–Ω—É—é

### 3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö**

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º —á–µ—Ä–µ–∑ Socket.io Gateway

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### Frontend:

```
web-admin/src/
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ socket.ts              # –°–µ—Ä–≤–∏—Å Socket.io
‚îú‚îÄ‚îÄ contexts/
‚îÇ   ‚îî‚îÄ‚îÄ NotificationContext.tsx # –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ Toast.tsx              # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useSocket.ts           # –•—É–∫ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Socket.io
‚îî‚îÄ‚îÄ App.tsx                    # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

### Backend:

```
backend/src/
‚îú‚îÄ‚îÄ notification/
‚îÇ   ‚îú‚îÄ‚îÄ notification.gateway.ts  # Socket.io Gateway
‚îÇ   ‚îî‚îÄ‚îÄ notification.module.ts
‚îî‚îÄ‚îÄ orders/
    ‚îî‚îÄ‚îÄ orders.service.ts        # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–æ–≤
```

## üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Socket.io

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

Socket.io –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ —Ö—É–∫ `useSocket()`:

```typescript
// –í App.tsx
useSocket(); // –ü–æ–¥–∫–ª—é—á–∞–µ–º Socket.io
```

### –†—É—á–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

```typescript
import { socketService } from "./services/socket";

// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
const socket = socketService.connect(token);

// –û—Ç–∫–ª—é—á–µ–Ω–∏–µ
socketService.disconnect();
```

## üì® –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

### Backend ‚Üí Frontend:

1. **`order_created`** - –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω
   ```typescript
   {
     id: string;
     totalAmount: number;
     status: string;
     clientId: string;
     createdAt: Date;
   }
   ```

2. **`order_status_changed`** - –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –∏–∑–º–µ–Ω–µ–Ω
   ```typescript
   {
     orderId: string;
     status: string;
   }
   ```

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

```typescript
import { useNotifications } from "../contexts/NotificationContext";

function MyComponent() {
  const { showNotification } = useNotifications();

  const handleClick = () => {
    showNotification({
      type: "success",
      title: "–£—Å–ø–µ—à–Ω–æ!",
      message: "–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞",
      duration: 5000, // 5 —Å–µ–∫—É–Ω–¥, 0 = –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    });
  };

  return <button onClick={handleClick}>–ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</button>;
}
```

### –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

```typescript
// Success (–∑–µ–ª–µ–Ω–æ–µ)
showNotification({
  type: "success",
  title: "–£—Å–ø–µ—à–Ω–æ!",
  message: "–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞",
});

// Error (–∫—Ä–∞—Å–Ω–æ–µ)
showNotification({
  type: "error",
  title: "–û—à–∏–±–∫–∞!",
  message: "–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫",
});

// Warning (–∂–µ–ª—Ç–æ–µ)
showNotification({
  type: "warning",
  title: "–í–Ω–∏–º–∞–Ω–∏–µ!",
  message: "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ",
});

// Info (—Å–∏–Ω–µ–µ)
showNotification({
  type: "info",
  title: "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",
  message: "–ù–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ",
});
```

## üé® –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è

Toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç Tailwind CSS:

- **–ü–æ–∑–∏—Ü–∏—è**: –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ —Å–ø—Ä–∞–≤–∞ —Å–≤–µ—Ä—Ö—É
- **–ê–Ω–∏–º–∞—Ü–∏—è**: –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–∞ (`slide-in-right`)
- **–¶–≤–µ—Ç–∞**: 
  - Success: –∑–µ–ª–µ–Ω—ã–π
  - Error: –∫—Ä–∞—Å–Ω—ã–π
  - Warning: –∂–µ–ª—Ç—ã–π
  - Info: —Å–∏–Ω–∏–π

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è:

–ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ç–∏–ª–∏ –≤ `web-admin/src/components/Toast.tsx`:

```tsx
const getBgColor = (type: Notification["type"]) => {
  // –í–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞
};
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
# Frontend (.env)
VITE_API_URL=http://localhost:3000

# Backend (.env)
FRONTEND_URL=http://localhost:5173
```

### Backend Socket.io:

–ù–∞—Å—Ç—Ä–æ–µ–Ω –≤ `backend/src/notification/notification.gateway.ts`:

```typescript
@WebSocketGateway({
  cors: {
    origin: "*", // –í production —É–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–º–µ–Ω
  },
})
```

## üìä –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞:

–ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ API:

```typescript
// Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
this.notificationGateway.emitOrderCreated({
  id: saved.id,
  totalAmount: saved.totalAmount,
  status: saved.status,
  clientId: saved.clientId,
  createdAt: saved.createdAt,
});
```

### –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞:

```typescript
// Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:
this.notificationGateway.emitOrderStatusChanged(saved.id, saved.status);
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

```
‚úÖ Socket.io connected: <socket-id>
‚ùå Socket.io disconnected: <reason>
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –í DevTools Console –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
socketService.isConnected(); // –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å true

// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ (–Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞ –±—ç–∫–µ–Ω–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
```

## üöÄ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π:

1. **–ù–∞ –±—ç–∫–µ–Ω–¥–µ** (notification.gateway.ts):
```typescript
emitPaymentReceived(payment: any) {
  this.server.emit("payment_received", payment);
}
```

2. **–ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ** (useSocket.ts):
```typescript
socketService.on("payment_received", (payment) => {
  showNotification({
    type: "success",
    title: "–ü–ª–∞—Ç–µ–∂ –ø–æ–ª—É—á–µ–Ω",
    message: `–ü–æ–ª—É—á–µ–Ω –ø–ª–∞—Ç–µ–∂ –Ω–∞ —Å—É–º–º—É ${payment.amount} ‚ÇΩ`,
  });
});
```

### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**: Socket.io –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–≤—è–∑–∏
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ –ø–∞–º—è—Ç–∏ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: Socket.io –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JWT —Ç–æ–∫–µ–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis Adapter –¥–ª—è Socket.io

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–°–∏—Å—Ç–µ–º–∞ real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.


