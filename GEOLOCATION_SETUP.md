# üåç –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∏ –∫–∞—Ä—Ç

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### Backend
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –∞–¥—Ä–µ—Å–∞ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ `Order` entity
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –≤ `MasterProfile` entity
- ‚úÖ –°–æ–∑–¥–∞–Ω `GeolocationService` –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π (—Ñ–æ—Ä–º—É–ª–∞ Haversine)
- ‚úÖ API endpoints –¥–ª—è –ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤
- ‚úÖ API endpoint –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞

### Frontend
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Yandex Maps API
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `OrdersMap` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `RoutePlanner` –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –º–∞—Å—Ç–µ—Ä–æ–≤
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–µ–π –∏ –∫–∞—Ä—Ç–æ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç)
- ‚úÖ –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤

## üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex Maps API

1. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á:
   - –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://developer.tech.yandex.ru/
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
   - –°–æ–∑–¥–∞–π—Ç–µ JavaScript API –∫–ª—é—á –¥–ª—è –∫–∞—Ä—Ç

2. –ó–∞–º–µ–Ω–∏—Ç–µ `YOUR_API_KEY` –≤ `web-admin/index.html`:
   ```html
   <script src="https://api-maps.yandex.ru/2.1/?apikey=–í–ê–®_API_–ö–õ–Æ–ß&lang=ru_RU" type="text/javascript"></script>
   ```

3. –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ –∫–ª—é—á–∞, –Ω–æ –±—É–¥—É—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
   - –ë–µ–∑ –∫–ª—é—á–∞: –¥–æ 25 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
   - –° –∫–ª—é—á–æ–º: –¥–æ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É

## üìç –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É **–ó–∞–∫–∞–∑—ã**
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üó∫Ô∏è –ö–∞—Ä—Ç–∞** –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç—É
3. –ó–∞–∫–∞–∑—ã —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –æ—Ç–æ–±—Ä–∞–∑—è—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ
4. –¶–≤–µ—Ç –º–µ—Ç–æ–∫ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç–∞—Ç—É—Å–∞:
   - üü° –ñ–µ–ª—Ç—ã–π - —Å–æ–∑–¥–∞–Ω
   - üîµ –°–∏–Ω–∏–π - –≤ —Ä–∞–±–æ—Ç–µ
   - üü¢ –ó–µ–ª–µ–Ω—ã–π - –∑–∞–≤–µ—Ä—à–µ–Ω
   - üî¥ –ö—Ä–∞—Å–Ω—ã–π - –≤—ã–±—Ä–∞–Ω

### –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤

1. –ù–∞ –∫–∞—Ä—Ç–µ –≤—ã–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑ (–∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –º–µ—Ç–∫—É)
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–ü–æ–∫–∞–∑–∞—Ç—å –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤"**
3. –°–∏—Å—Ç–µ–º–∞ –Ω–∞–π–¥–µ—Ç –º–∞—Å—Ç–µ—Ä–æ–≤ –≤ —Ä–∞–¥–∏—É—Å–µ 50 –∫–º –æ—Ç –∑–∞–∫–∞–∑–∞
4. –°–ø–∏—Å–æ–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è —Å–ª–µ–≤–∞ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è–º–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∫ –∑–∞–∫–∞–∑—É

1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞:
   - –í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –≤ –ø–æ–ª–µ "–ê–¥—Ä–µ—Å"
   - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üìç** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—Ä—É—á–Ω—É—é (—à–∏—Ä–æ—Ç–∞, –¥–æ–ª–≥–æ—Ç–∞)

### –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `RoutePlanner` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞:
```tsx
<RoutePlanner
  startPoint={{ latitude: 55.7558, longitude: 37.6173 }}
  orders={ordersWithCoordinates}
  onRouteCalculated={(route) => console.log(route)}
/>
```

## üîß API Endpoints

### –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤
```
GET /api/geolocation/masters/nearest?latitude=55.7558&longitude=37.6173&radius=50&limit=10
```

### –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤ –¥–ª—è –∑–∞–∫–∞–∑–∞
```
GET /api/geolocation/orders/:orderId/masters/nearest?radius=50&limit=10
```

### –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
```
POST /api/geolocation/route
Body: {
  startPoint: { latitude: number, longitude: number },
  points: [{ latitude: number, longitude: number }]
}
```

## üìä –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–æ—Ä–º—É–ª–∞ **Haversine** –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏ –Ω–∞ —Å—Ñ–µ—Ä–µ:
- –¢–æ—á–Ω–æ—Å—Ç—å: ¬±0.5% (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π)
- –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è: –∫–∏–ª–æ–º–µ—Ç—Ä—ã

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ù–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—ã:

**orders:**
- `address` (varchar, nullable)
- `latitude` (decimal(10,8), nullable)
- `longitude` (decimal(11,8), nullable)

**master_profiles:**
- `address` (varchar, nullable)
- `latitude` (decimal(10,8), nullable)
- `longitude` (decimal(11,8), nullable)
- `isAvailable` (boolean, default: true)
- `serviceRadius` (int, nullable) - —Ä–∞–¥–∏—É—Å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –≤ –∫–º

–ü—Ä–∏ `synchronize: true` –≤ TypeORM (—Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) –ø–æ–ª—è –¥–æ–±–∞–≤—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ.

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **API –∫–ª—é—á Yandex Maps** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–ª—É—á–∏—Ç–µ —Å–≤–æ–π –∫–ª—é—á –¥–ª—è production
2. **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç: —à–∏—Ä–æ—Ç–∞ –æ—Ç -90 –¥–æ 90, –¥–æ–ª–≥–æ—Ç–∞ –æ—Ç -180 –¥–æ 180
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –¥–ª—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—Å—Ç–µ—Ä–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ `latitude` –∏ `longitude`
4. **–ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏ (Yandex Maps)

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–µ–∫ –Ω–∞ –∫–∞—Ä—Ç–µ
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–±–∏–ª—å–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–∞—Å—Ç–µ—Ä–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

