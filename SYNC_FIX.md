# Исправление синхронизации данных

## Проблема
Данные не синхронизируются между мобильным приложением и админ-панелью.

## Решение

### 1. Backend (улучшено)
- ✅ WebSocket события теперь отправляют полный объект заказа
- ✅ События: `order_created`, `order_status_changed` (с полным объектом)

### 2. Web Admin (улучшено)
- ✅ Добавлен polling каждые 15 секунд для автоматической синхронизации
- ✅ Автоматическое обновление при фокусе окна
- ✅ WebSocket listeners для real-time обновлений
- ✅ Обработка событий `order_created` и `order_status_changed`

### 3. Mobile App (нужно проверить)
- ⚠️ Использует polling каждые 15 минут (настроено в RTK Query)
- ⚠️ WebSocket подключение к `ws://localhost:3000/api/orders/stream` (не существует)
- ⚠️ RTK Query автоматически инвалидирует кеш при мутациях

## Рекомендации

### Для мобильного приложения:
1. **Использовать Socket.io клиент** вместо WebSocket:
   ```bash
   npm install socket.io-client
   ```

2. **Или увеличить частоту polling**:
   ```typescript
   pollingInterval: 15 * 1000, // 15 секунд вместо 15 минут
   ```

3. **Или добавить инвалидацию кеша при получении WebSocket событий**

### Текущий статус:
- ✅ Backend отправляет полные данные через WebSocket
- ✅ Web Admin получает и обрабатывает обновления в реальном времени
- ⚠️ Mobile App нуждается в доработке WebSocket подключения

## Тестирование

1. Откройте админ-панель: http://localhost:5173
2. Откройте мобильное приложение
3. Создайте или измените заказ в админ-панели
4. Проверьте обновление в мобильном приложении (через 15 минут или после ручного обновления)

## Быстрое решение для Mobile App

Увеличьте частоту polling в `mobile-app/src/screens/OrderFeedScreen.tsx`:
```typescript
pollingInterval: 15 * 1000, // 15 секунд вместо 15 минут
```








